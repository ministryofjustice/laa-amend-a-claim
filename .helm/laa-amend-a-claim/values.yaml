# Default values for laa-amend-a-claim.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 3

image:
  repository: nginx  # Override with ECR repository at deploy time
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: "laa-amend-a-claim"

serviceAccount:
  # Specifies whether a service account should be created
  create: false
  # Automatically mount a ServiceAccount's API credentials?
  automount: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations: {}
podLabels: {}

podSecurityContext: {}

securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false
  seccompProfile:
    type: RuntimeDefault
  capabilities:
    drop: ["ALL"]

service:
  type: ClusterIP
  port: 8080

namespace: ""  # Override at deploy time

ingress:
  enabled: true
  className: "modsec"
  host: ""  # Override at deploy time
  cluster:
    name: green
    weight: "100"
  annotations:
    nginx.ingress.kubernetes.io/affinity: "cookie"
    nginx.ingress.kubernetes.io/session-cookie-name: "sticky"
    nginx.ingress.kubernetes.io/session-cookie-hash: sha1
    nginx.ingress.kubernetes.io/session-cookie-expires: "172800"
    nginx.ingress.kubernetes.io/session-cookie-max-age: "172800"
    nginx.ingress.kubernetes.io/modsecurity-snippet: |
      SecRuleEngine On
      SecAuditEngine On
      SecDefaultAction "phase:2,pass,log,tag:github_team=laa-amend-a-claim"
      SecDebugLogLevel 1

resources:
  requests:
    memory: "1200Mi"
    cpu: "300m"
  limits:
    memory: "3000Mi"
    cpu: "1"

startupProbe:
  httpGet:
    path: /actuator/health
    port: http
  failureThreshold: 30
  periodSeconds: 10

livenessProbe:
  httpGet:
    path: /actuator/health/liveness
    port: http
  periodSeconds: 10

readinessProbe:
  httpGet:
    path: /actuator/health/readiness
    port: http
  periodSeconds: 10

# Sentry environment name (override at deploy time)
sentryEnvironment: ""

# Environment variables
env:
  - name: AZURE_CLIENT_ID
    valueFrom:
      secretKeyRef:
        name: laa-amend-a-claim-azure-client-id
        key: AZURE_CLIENT_ID
  - name: AZURE_CLIENT_SECRET
    valueFrom:
      secretKeyRef:
        name: laa-amend-a-claim-azure-client-secret
        key: AZURE_CLIENT_SECRET
  - name: AZURE_TENANT_ID
    valueFrom:
      secretKeyRef:
        name: laa-amend-a-claim-azure-tenant
        key: AZURE_TENANT_ID
  - name: BASE_URL_HOMEPAGE
    valueFrom:
      secretKeyRef:
        name: laa-amend-a-claim-base-url
        key: BASE_URL_HOMEPAGE
  - name: SENTRY_DSN
    valueFrom:
      secretKeyRef:
        name: laa-amend-a-claim-sentry-dsn
        key: SENTRY_DSN
  - name: CLAIMS_API
    valueFrom:
      secretKeyRef:
        name: laa-amend-a-claim-claims-api-url
        key: CLAIMS_API
  - name: CLAIMS_TOKEN
    valueFrom:
      secretKeyRef:
        name: laa-amend-a-claim-claims-api-token
        key: CLAIMS_TOKEN
  - name: REDIS_URL
    valueFrom:
      secretKeyRef:
        name: elasticache-redis
        key: url
  - name: FEEDBACK_URL
    valueFrom:
      configMapKeyRef:
        name: urls
        key: feedback
  - name: LAA_URL
    valueFrom:
      configMapKeyRef:
        name: urls
        key: laa
  - name: PROVIDER_API
    valueFrom:
      secretKeyRef:
        name: laa-amend-a-claim-provider-api-url
        key: PROVIDER_API
  - name: PROVIDER_TOKEN
    valueFrom:
      secretKeyRef:
        name: laa-amend-a-claim-provider-api-token
        key: PROVIDER_TOKEN

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

volumes: []

volumeMounts: []

nodeSelector: {}

# Do not create a new redis pod (We use AWS ElastiCache for Redis for all non-ephemeral environments)
redis:
  enabled: false

tolerations: []

affinity: {}
