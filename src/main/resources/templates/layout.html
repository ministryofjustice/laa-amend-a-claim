<html th:fragment="layout(title,mainContent,pageCategory,showBackLink)" lang="en" class="govuk-template govuk-template--rebranded">

    <head th:replace="~{partials/head :: head(title=${title})}"></head>

    <body class="govuk-template__body">
        <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>

        <a href="#main-content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <th:block th:replace="~{partials/header :: header}"></th:block>

        <th:block th:replace="~{partials/service-navigation :: serviceNavigation(pageCategory=${pageCategory})}"></th:block>

        <div class="govuk-width-container">
            <div class="govuk-phase-banner" id="feedback">
                <p class="govuk-phase-banner__content">
                    <strong class="govuk-tag govuk-phase-banner__content__tag">
                        Alpha
                    </strong>
                    <span class="govuk-phase-banner__text">
                        This is a new service. Your <a class="govuk-link" href="#">feedback</a> will help us to improve it.
                    </span>
                </p>
            </div>

            <!-- Back link with explicit URL -->
            <a th:if="${showBackLink and backUrl != null}"
               th:href="${backUrl}"
               class="govuk-back-link"
               th:text="#{service.back}">
            </a>

            <!-- Fallback: go back in history -->
            <a th:if="${showBackLink and backUrl == null}"
               href="#"
               onclick="window.history.go(-1); return false;"
               class="govuk-back-link"
               th:text="#{service.back}">
            </a>

            <th:block th:replace="${mainContent}">Default Main Content</th:block>
        </div>

        <th:block th:replace="~{partials/footer :: footer}"></th:block>

        <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
        <script type="module" th:src="@{/webjars/govuk-frontend/dist/govuk/govuk-frontend.min.js}"></script>
        <script type="module" th:src="@{/webjars/ministryofjustice__frontend/moj/moj-frontend.min.js}"></script>
        <script type="module">
            import * as GOVUKFrontend from '/webjars/govuk-frontend/dist/govuk/govuk-frontend.min.js'
            import * as MOJFrontend from '/webjars/ministryofjustice__frontend/moj/moj-frontend.min.js'

            GOVUKFrontend.initAll()
            MOJFrontend.initAll()
        </script>
    </body>

</html>