<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: layout(
        title=#{claimSummary.title},
        mainContent=~{::#main-content},
        pageCategory=${null},
        showBackLink=${true}
    )}">
    <body>
        <main class="govuk-main-wrapper" id="main-content">
            <div class="govuk-width-container">
                <div class="govuk-grid-row">
                    <div class="govuk-grid-column-two-thirds">
                        <div aria-labelledby="govuk-notification-banner-title" class="govuk-notification-banner"
                             data-module="govuk-notification-banner" role="region" th:if="${claim.hasAssessment}">
                            <div class="govuk-notification-banner__content"
                                 style="display:flex; align-items:flex-start; gap:12px;">
                                <!-- Notification text -->
                                <span class="claim-details-icon-info">i</span>
                                <div>
                                    <h3 class="govuk-notification-banner__heading">
                                        This claim has been assessed
                                    </h3>
                                    <p class="govuk-body"
                                       th:text="#{claimSummary.lastAssessmentText(${user?.displayName}, ${claim.lastAssessedDate}, ${claim.lastAssessedTime})}">
                                    </p>
                                    <p th:if="${claim.lastAssessmentOutcomeKey}" th:text="#{${'claimSummary.' + claim.lastAssessmentOutcomeKey}}"></p>
                                </div>
                            </div>
                        </div>

                        <h1 class="govuk-heading-l">
                            <span th:text="#{claimSummary.mainHeading}"></span>
                        </h1>
                        <div class="govuk-summary-card" th:if="${claim != null}">
                            <div class="govuk-summary-card__title-wrapper">
                                <h2 class="govuk-summary-card__title" th:text="#{claimSummary.summary}"></h2>
                            </div>
                            <div class="govuk-summary-card__content">
                                <dl class="govuk-summary-list">
                                    <div class="govuk-summary-list__row" th:each="entry : ${claim.summaryRows}">
                                        <dt class="govuk-summary-list__key" th:text="#{${'claimSummary.rows.' + entry.key}}"></dt>
                                        <dd class="govuk-summary-list__value" th:text="${@ThymeleafUtils.getFormattedValue(entry.value)}"></dd>
                                    </div>
                                </dl>
                            </div>
                        </div>

                        <div class="govuk-summary-card" th:if="${claim != null}">
                            <div class="govuk-summary-card__title-wrapper">
                                <h2 class="govuk-summary-card__title" th:text="#{claimSummary.values}"></h2>
                            </div>
                            <div class="govuk-summary-card__content">
                                <dl class="govuk-summary-list">
                                    <div class="govuk-summary-list__row">
                                        <dt class="govuk-summary-list__key" th:text="#{claimSummary.item}"></dt>
                                        <dd class="govuk-summary-list__value govuk-!-font-weight-bold" th:text="#{claimSummary.calculated}"></dd>
                                        <dd class="govuk-summary-list__value govuk-!-font-weight-bold" th:text="#{claimSummary.submitted}"></dd>
                                        <dd class="govuk-summary-list__value govuk-!-font-weight-bold" th:if="${claim.hasAssessment}" th:text="#{claimSummary.assessed}"></dd>
                                    </div>
                                    <div class="govuk-summary-list__row" th:each="row : ${claim.tableRows}" th:if="${@ThymeleafUtils.displayClaimField(row)}">
                                        <dt class="govuk-summary-list__key govuk-!-font-weight-bold" th:text="#{${row.label}}"></dt>
                                        <dd class="govuk-summary-list__value" th:text="${@ThymeleafUtils.getFormattedValue(row.calculated)}"></dd>
                                        <dd class="govuk-summary-list__value" th:text="${@ThymeleafUtils.getFormattedValue(row.submitted)}"></dd>
                                        <dd class="govuk-summary-list__value" th:if="${claim.hasAssessment}"
                                            th:text="${@ThymeleafUtils.getFormattedValue(row.assessed)}"></dd>
                                    </div>
                                </dl>
                                <div class="govuk-inset-text" th:if="${claim.hasAssessment}">
                                    <th:text
                                            th:text="#{claimSummary.totalAssessmentText(${@ThymeleafUtils.getAssessedValue(claim.claim().allowedTotalInclVat)})}"></th:text>
                                </div>
                            </div>
                        </div>

                        <div class="govuk-button-group">
                            <a th:href="@{/submissions/{submissionId}/claims/{claimID}/assessment-outcome(submissionId=${submissionId}, claimID=${claimId})}"
                               th:text="#{claimSummary.assessmentButton}" class="govuk-button">
                            </a>
                            <a th:href="@{/}"
                               role="button" draggable="false" class="govuk-button govuk-button--secondary"
                               th:text="#{claimSummary.backToSearch}" data-module="govuk-button">
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </body>
</html>
